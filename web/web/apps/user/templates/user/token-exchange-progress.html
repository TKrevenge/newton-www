{% extends "base.html" %}
{% load i18n %}
{% load utils %}

{% block require_title %}
<title>{% trans "user" %} | {% trans "Newton Community" %}</title>
{% endblock %}

{% block header %}
{% include "header-no-menu.html" %}
{% endblock %}

{% block footer %}
{% include "footer-simple.html" %}
{% endblock %}

{% block notice %}
{% endblock %}

{% block content %}
<section id="user" class="section-list">
    <div class="page-title">
        <div class="container header">
            <img class="header" src="{% version "images/default_avator.png" %}"/>
            <div class="name">
            </div>
            <div class="location">
            </div>
        </div>
    </div>
    
    <div id="token-exchange" class="user-content">
        <div class="container">
            <div class="raw user-detail-content">
                <div class="user-info">
                    {% if item %}
                    {% include "tokenexchange/token-exchange-info.html" %}
                    <div class="item">
                        <div class="item-content">
                            {% if item.expect_btc or item.except_ela %}
                            <script>var hasExpect = true;</script>
                            <div class="auto-table">
                                <table class="table">
                                    <h1>Expect Info</h1>
                                    <thead>
                                        <tr>
                                            <td></td>
                                            <td>BTC</td>
                                            <td>ELA</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>{% trans "Apply Amount" %}</td>
                                            {% if item.expect_btc %}
                                            <td><span class="f30">{{ item.expect_btc }}</span> BTC</td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                            {% if item.expect_ela %}
                                            <td><span class="f30">{{ item.expect_ela }}</span> ELA</td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                                    {% if item.assign_btc or item.assign_ela or item.receive_btc_address or item.receive_ela_address %}
                            <div class="auto-table">
                                <table class="table">
                                    <h1>Apply Info</h1>
                                    <thead>
                                        <tr>
                                            <td></td>
                                            <td>BTC</td>
                                            <td>ELA</td>
                                        </tr>
                                    </thead>
                                    <tbody>    
                                        <tr>
                                            <td>{% trans "Distribution Amount" %}</td>
                                            {% if item.assign_btc %}
                                            <td><span class="f30">{{ item.assign_btc }}</span> BTC</td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                            {% if item.assign_ela %}
                                            <td><span class="f30">{{ item.assign_ela }}</span> ELA</td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <td>{% trans "Distribution Address" %}</td>
                                            {% if item.receive_btc_address %}
                                            <td>{{ item.receive_btc_address }}</td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                            {% if item.receive_ela_address %}
                                            <td>{{ item.receive_ela_address }}</td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                        </tr>
                                        <tr>
                                            <td>QR Code</td>
                                            {% if item.receive_btc_address %}
                                            <td id="code">
                                            <script>
                                                new QRCode(document.getElementById("code"), "{{ item.receive_btc_address }}");
                                            </script>
                                            </td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                            {% if item.receive_ela_address %}
                                            <td id="ela_qrcode">
                                                <script>
                                                new QRCode(document.getElementById("ela_qrcode"), "{{ item.receive_ela_address }}");
                                                </script>
                                            </td>
                                            {% else %}
                                            <td>-</td>
                                            {% endif %}
                                        </tr>
                                        
                                    {% if item.ela_final_balance or item.btc_final_balance %}
                                            <script>var hasSendAmount = true;</script>
                                            <tr>
                                                <td>{% trans "Receive Amount Of<br/> Newton Foundation" %}</td>
                                                {% if item.btc_final_balance %}
                                                <td><span class="f30">{{ item.btc_final_balance }}</span> BTC</td>
                                                {% else %}
                                                <td>-</td>
                                                {% endif %}
                                                {% if item.ela_final_balance %}
                                                <td><span class="f30">{{ item.ela_final_balance }}</span> ELA</td>
                                                {% else %}
                                                <td>-</td>
                                                {% endif %}
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                        {% if item.btc_final_balance != item.assign_btc or item.ela_final_balance != item.assign_ela %}
                                <div class="form-container mt50">
                                    <div class="alert alert-warning f30">
                                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                        Transferred limits is not equal to allocated limits.
                                    </div>
                                </div>
                                        {% else %}
                                <div class="form-container mt50">
                                    <div class="alert alert-success f30">
                                        <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
                                        Transfer success.
                                    </div>
                                </div>
                                        {% endif %}
                                {% else %}
                                        </tbody>
                                    </table>
                                </div>
                                <div class="form-container mt50">
                                    <div class="alert alert-warning f30">
                                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                        * You can transfer BTC and ELA through your wallet.<br/>
                                        <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                                        * After you finish transferring, you will check out transfer information on this page,
                                        and soon you will check the transferring result on this page.
                                    </div>
                                </div>
                                {% endif %}
                                {% else %}
                                    <!-- add else for no assign btc or assign ela -->
                                </tbody>
                            </table>
                        </div>
                        <div class="form-container mt50">
                            <div class="alert alert-warning f30">
                                <span class="glyphicon glyphicon-hand-right" aria-hidden="true"></span>
                                your expected limit is under evaluation.
                            </div>
                        </div>
                        {% endif %}
                            <!-- end -->
                            {% else %}
                            <a class="form-button" href="/tokenexchange/invite/{{ item.id }}/post/">{% trans "Fill in the expected investment quota " %}</a>
                            {% endif %}
                        </div>
                    </div>
                    {% else %}
                    <div class="item">
                        <p>No TokenExchange Information.</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block inline_js %}

{% endblock %}
