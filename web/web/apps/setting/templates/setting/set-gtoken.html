{% extends "base.html" %}
{% load i18n %}
{% load utils %}

{% block title %}{% trans "Link Google Authenticator" %}{% endblock %}
{% block site_name %}{% trans "Newton Community" %}{% endblock %}

{% block header %}
{% include "header-no-menu.html" %}
{% endblock %}

{% block footer %}
{% include "footer-simple.html" %}
{% endblock %}

{% block notice %}
{% endblock %}

{% block content %}
<section id="reset" class="section-list">
	<div class="page-title">
		<div class="container">
			<p class="set-gtoken-title">{% trans "Link Google Authenticator" %}
			</p>
		</div>
	</div>
    
    <div class="container text-center" style="color: #999">
        <div>
            <p>
                {% trans "Google Authenticator generates dynamic passwords and it is similar to SMS dynamic verification." %}
            </p>
            <p>
                {% trans "Google Authenticator generates a new code every 30 seconds after you bind it to apps." %}
            </p>
        </div>
        <div>
            <p>{% trans "Google Authenticator verification code can make your information and data security on Newton official website." %}</p>
        </div>
        <div>
            <p style="color: red">{% trans "Please be sure to keep the key or qr code to avoid any inconvenience." %}</p>
        </div>
    </div>
    <div class="container">
        <div class="form-container">
            <form id="id_set_gtoken_form" class="form" action="/setting/gtoken/post/?redirect_url={{ redirect_url }}" method="POST">
                {% csrf_token %}
                <div id="code-area" class="col-lg-12 col-md-12 col-sm-12">
                    <div class="form-group col-lg-6 col-md-12 col-sm-12" id="manually-code">
                        <label for="id_gtoken" class="control-label" style="font-size: 14px; color: #999; padding-right: 0">{% trans "Enter the  code manually into your GA app" %}</label>
                        <div id="key" style="font-size: 18px; color: #292929">{{ gtoken }}</div>
                    </div>
                    <div class="form-group col-lg-6 col-md-12 col-sm-12" style="text-align: center; margin: 0 auto;" id="qr-code">
                        <label for="id_gtoken" class="control-label" style="font-size: 14px; color: #999">{% trans "Use the GA app to scan the QR code" %}</label>
                        <div id="code"></div> 
                    </div>
                </div>
                <div class="col-lg-12 gtoken-code-container">
                    {% include "form.html" %}
                    <div class="form-group" style="margin-left: auto; margin-right: auto">
                        <input type="hidden" id="id_redirect_url" name="redirect_url" value="{{ redirect_url }}"/>
                        <button class="form-button" type="submit">{% trans "Submit" %}</button>
                    </div>
                </div>
            </form>
        </div>   
    </div>
</section>
{% endblock %}

{% block inline_js %}
<script type="text/javascript">
    new QRCode(document.getElementById("code"), "{{ gtoken_uri }}");
    
    function jsCopy(){ 
        var e=document.getElementById("gtoken-key");
        e.select();
        document.execCommand("Copy");
    }
</script>
{% endblock %}

{% block js %}
<script src="{% version "js/setting.js" %}"></script>
{% endblock %}
