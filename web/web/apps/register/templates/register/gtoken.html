{% extends "base.html" %}
{% load i18n %}
{% load utils %}

{% block title %}{% trans "Add Google Authenticator" %}{% endblock %}
{% block site_name %}{% trans "Newton Community" %}{% endblock %}

{% block header %}
{% include "header-no-menu.html" %}
{% endblock %}

{% block footer %}
{% include "footer-simple.html" %}
{% endblock %}

{% block notice %}
{% endblock %}

{% block content %}
<section id="reset" class="section-list">
	<div class="page-title">
		<div class="container">
			<p>{% trans "Add Google Authenticator" %}
			</p>
		</div>
	</div>
    
    <div class="container text-center" style="color: #999">
        <div>
            <p> <span style="color: red">{% trans "Enter the code manually" %}</span> {% trans "or" %}<span style="color: red"> {% trans "scan the QR code" %}</span> {% trans "into your GA app" %}</p>
        </div>
        <div>
            <p>{% trans "Apple users are recommended to download Google Authenticator directly from the App Store" %},</p>
            <p>{% trans "and Android users are recommended to download Google Authenticator from Google Play." %}</p>
        </div>
        <div>
            <p style="color: red">{% trans "Please be sure to keep the key or qr code to avoid any inconvenience." %}</p>
        </div>
    </div>
    <div class="container">
        <div class="form-container">
            <form id="id_set_gtoken_form" class="form" action="/register/gtoken/post/" method="POST">
                {% csrf_token %}
                <input id="email" name="email" type="hidden" value="{{ email }}"/>
                <input id="password" name="password" type="hidden" value="{{ password }}"/>
                <input id="uuid" name="uuid" type="hidden" value="{{ uuid }}"/>
                <input id="gtoken" name="gtoken" type="hidden" value="{{ gtoken }}"/>
                <input id="auth_token" name="auth_token" type="hidden" value="{{ auth_token }}"/>
                <div id="code-area" class="col-lg-12 col-md-12 col-sm-12">
                    <div class="form-group col-lg-6 col-md-12 col-sm-12" id="manually-code">
                        <label for="id_gtoken" class="control-label" style="font-size: 14px; color: #999; padding-right: 0">{% trans "Enter the  code manually into your GA app" %}</label>
                        <div id="key" style="font-size: 18px; color: #292929">{{ gtoken }}</div>
                        {% comment %}    
                        <textarea name="" id="gtoken-key" style=" resize: none; outline: none; border:none; height: 20px; overflow: hidden;">{{ gtoken }}</textarea>
                            <input type="button" value="{% trans "Copy" %}" onclick="jsCopy()" style="width: unset; height: unset; padding: 0;">
                        {% endcomment %}
                    </div>
                    {% comment %}
                    <div class="form-group">
                        <label>{% trans "Or"  %}</label>
                    </div>
                    {% endcomment %}
                    <div class="form-group col-lg-6 col-md-12 col-sm-12" style="text-align: center; margin-bottom: 0" id="qr-code">
                        <label for="id_gtoken" class="control-label" style="font-size: 14px; color: #999">{% trans "Use the GA app to scan the QR code" %}</label>
                        <div id="code"></div> 
                    </div>
                </div>
                <div class="col-lg-12" style="text-align: center">
                    {% include "form.html" %}
                    <div class="form-group" style="margin-left: auto; margin-right: auto">
                        <button class="form-button" type="submit">{% trans "Submit" %}</button>
                    </div>
                </div>
            </form>
        </div>   
    </div>
</section>
{% endblock %}

{% block inline_js %}
<script type="text/javascript">
    new QRCode(document.getElementById("code"), "{{ gtoken_uri }}");
    
    function jsCopy(){ 
        var e=document.getElementById("gtoken-key");
        e.select();
        document.execCommand("Copy");
    }
</script>
{% endblock %}

{% block js %}
<script src="{% version "js/register.js" %}"></script>
{% endblock %}
